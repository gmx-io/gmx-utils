{"version":3,"sources":["../../../../../src/transactions/builder/typeUtils.ts"],"names":[],"mappings":"AA0FO,SAAS,aAAA,CAId,OACA,OAAA,EAC4B;AAC5B,EAAA,OAAO;AAAA,IACL,GAAG,KAAA;AAAA,IACH,GAAG;AAAA,GACL;AACF;AAEO,SAAS,oBAAA,CAId,OACA,iBAAA,EAC4B;AAC5B,EAAA,MAAM,eAAA,GAAkB;AAAA,IACtB,GAAG,KAAA,CAAM,YAAA;AAAA,IACT,GAAG;AAAA,GACL;AAEA,EAAA,OAAO;AAAA,IACL,GAAG,KAAA;AAAA,IACH,YAAA,EAAc;AAAA,GAChB;AACF","file":"typeUtils.js","sourcesContent":["import { ExpressTxnParams, GlobalExpressParams } from \"../express/types\";\n\nexport type BaseCapabilities = {\n  canSendWallet: boolean;\n  canSendExpress: boolean;\n  canSendOneClick: boolean;\n  hasExpressParams: boolean;\n  hasEstimatedExpress: boolean;\n  hasSignature: boolean;\n};\n\nexport type BaseInitialCapabilities = {\n  canSendWallet: true;\n  canSendExpress: false;\n  canSendOneClick: false;\n  hasExpressParams: false;\n  hasEstimatedExpress: false;\n  hasSignature: false;\n};\n\nexport type HasCapability<\n  TCaps extends BaseCapabilities,\n  TKey extends keyof TCaps,\n  TValue = true\n> = TCaps[TKey] extends TValue ? true : false;\n\nexport type RequireCapabilities<\n  TCaps extends BaseCapabilities,\n  TRequired extends Partial<BaseCapabilities>\n> = {\n  [K in keyof TRequired]: K extends keyof TCaps\n    ? TRequired[K] extends TCaps[K]\n      ? true\n      : false\n    : false;\n}[keyof TRequired] extends true\n  ? true\n  : false;\n\nexport type WithCapabilities<\n  TCaps extends BaseCapabilities,\n  TUpdates extends Partial<BaseCapabilities>\n> = Omit<TCaps, keyof TUpdates> & TUpdates;\n\nexport type BaseBuilderState<TCaps extends BaseCapabilities> = {\n  capabilities: TCaps;\n  expressGlobParams?: GlobalExpressParams;\n  estimatedExpressParams?: ExpressTxnParams;\n  signature?: string;\n};\n\nexport type ExpressMethods<TCaps extends BaseCapabilities, TBuilder> = {\n  setExpressParams: (params: GlobalExpressParams) => TBuilder & {\n    capabilities: WithCapabilities<TCaps, { hasExpressParams: true }>;\n  };\n\n  estimate: HasCapability<TCaps, \"hasExpressParams\"> extends true\n    ? () => Promise<\n        TBuilder & {\n          capabilities: WithCapabilities<TCaps, { hasEstimatedExpress: true }>;\n        }\n      >\n    : never;\n\n  sign: HasCapability<TCaps, \"hasEstimatedExpress\"> extends true\n    ? () => Promise<\n        TBuilder & {\n          capabilities: WithCapabilities<\n            TCaps,\n            { hasSignature: true; canSendExpress: true; canSendOneClick: true }\n          >;\n        }\n      >\n    : never;\n\n  sendExpressTransaction: HasCapability<TCaps, \"canSendExpress\"> extends true\n    ? () => Promise<void>\n    : never;\n\n  sendOneClickTransaction: HasCapability<TCaps, \"canSendOneClick\"> extends true\n    ? () => Promise<void>\n    : never;\n};\n\nexport type SendMethods<TCaps extends BaseCapabilities> = {\n  sendWalletTransaction: HasCapability<TCaps, \"canSendWallet\"> extends true\n    ? () => Promise<void>\n    : never;\n};\n\nexport function withBaseState<\n  TNewCaps extends BaseCapabilities,\n  TCaps extends BaseCapabilities\n>(\n  state: BaseBuilderState<TCaps>,\n  updates: Partial<BaseBuilderState<TNewCaps>>\n): BaseBuilderState<TNewCaps> {\n  return {\n    ...state,\n    ...updates,\n  } as BaseBuilderState<TNewCaps>;\n}\n\nexport function withBaseCapabilities<\n  TNewCaps extends BaseCapabilities,\n  TCaps extends BaseCapabilities\n>(\n  state: BaseBuilderState<TCaps>,\n  capabilityUpdates: Partial<BaseCapabilities>\n): BaseBuilderState<TNewCaps> {\n  const newCapabilities = {\n    ...state.capabilities,\n    ...capabilityUpdates,\n  } as unknown as TNewCaps;\n\n  return {\n    ...state,\n    capabilities: newCapabilities,\n  } as BaseBuilderState<TNewCaps>;\n}\n"]}
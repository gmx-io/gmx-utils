{"version":3,"sources":["../../../../../src/domain/tokens/utils.ts"],"names":[],"mappings":"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","file":"utils.js","sourcesContent":["import { NATIVE_TOKEN_ADDRESS } from \"configs/tokens\";\nimport { expandDecimals } from \"lib/numbers\";\n\nimport { Token, TokenData, TokenPrices, TokensData } from \"./types\";\n\nexport function convertToTokenAmount(\n  usd: bigint | undefined,\n  tokenDecimals: number | undefined,\n  price: bigint | undefined\n) {\n  if (\n    usd === undefined ||\n    typeof tokenDecimals !== \"number\" ||\n    price === undefined ||\n    price <= 0\n  ) {\n    return undefined;\n  }\n\n  return (usd * expandDecimals(1, tokenDecimals)) / price;\n}\n\nexport function convertToUsd(\n  tokenAmount: bigint | undefined,\n  tokenDecimals: number | undefined,\n  price: bigint | undefined\n) {\n  if (\n    tokenAmount == undefined ||\n    typeof tokenDecimals !== \"number\" ||\n    price === undefined\n  ) {\n    return undefined;\n  }\n\n  return (tokenAmount * price) / expandDecimals(1, tokenDecimals);\n}\n\nexport function convertBetweenTokens(\n  tokenAmount: bigint | undefined,\n  fromToken: TokenData | undefined,\n  toToken: TokenData | undefined,\n  maximize: boolean\n) {\n  if (\n    tokenAmount === undefined ||\n    fromToken === undefined ||\n    toToken === undefined\n  ) {\n    return undefined;\n  }\n\n  if (getIsEquivalentTokens(fromToken, toToken)) {\n    return tokenAmount;\n  }\n\n  const fromPrice = maximize\n    ? fromToken.prices.maxPrice\n    : fromToken.prices.minPrice;\n  const toPrice = maximize ? toToken.prices.minPrice : toToken.prices.maxPrice;\n\n  const usd = convertToUsd(tokenAmount, fromToken.decimals, fromPrice)!;\n  const amount = convertToTokenAmount(usd, toToken.decimals, toPrice)!;\n\n  return amount;\n}\n\nexport function getMidPrice(prices: TokenPrices) {\n  return (prices.minPrice + prices.maxPrice) / 2n;\n}\n\nexport function getIsEquivalentTokens(token1: Token, token2: Token) {\n  if (token1.address === token2.address) {\n    return true;\n  }\n\n  if (\n    token1.wrappedAddress === token2.address ||\n    token2.wrappedAddress === token1.address\n  ) {\n    return true;\n  }\n\n  if (\n    (token1.isSynthetic || token2.isSynthetic) &&\n    token1.symbol === token2.symbol\n  ) {\n    return true;\n  }\n\n  return false;\n}\n\nexport function getTokenData(\n  tokensData?: TokensData,\n  address?: string,\n  convertTo?: \"wrapped\" | \"native\"\n) {\n  if (!address || !tokensData?.[address]) {\n    return undefined;\n  }\n\n  const token = tokensData[address];\n\n  if (convertTo === \"wrapped\" && token.isNative && token.wrappedAddress) {\n    return tokensData[token.wrappedAddress];\n  }\n\n  if (convertTo === \"native\" && token.isWrapped) {\n    return tokensData[NATIVE_TOKEN_ADDRESS];\n  }\n\n  return token;\n}\n\nexport function getIsWrap(token1: Token, token2: Token) {\n  return token1.isNative && token2.isWrapped;\n}\n\nexport function getIsUnwrap(token1: Token, token2: Token) {\n  return token1.isWrapped && token2.isNative;\n}\n\nexport function getIsStake(token1: Token, token2: Token) {\n  return (token1.isWrapped || token1.isNative) && token2.isStaking;\n}\n\nexport function getIsUnstake(token1: Token, token2: Token) {\n  return token1.isStaking && token2.isWrapped;\n}\n"]}
{"version":3,"sources":["../../../../../src/domain/pricing/slippage.ts"],"names":[],"mappings":";;;;AAKO,SAAS,oBAAA,CACd,eAAA,EACA,KAAA,EACA,UAAA,EACA,MAAA,EACA;AACA,EAAA,MAAM,mBAAA,GAAsB,oBAAA,CAAqB,UAAA,EAAY,MAAM,CAAA;AAEnE,EAAA,MAAM,mBAAA,GAAsB,mBAAA,GACxB,oBAAA,GAAuB,eAAA,GACvB,oBAAA,GAAuB,eAAA;AAE3B,EAAA,OAAO,OAAA,CAAQ,MAAA;AAAA,IACb,KAAA;AAAA,IACA,OAAO,mBAAmB,CAAA;AAAA,IAC1B;AAAA,GACF;AACF;AAEO,SAAS,qBAAA,CACd,iBACA,eAAA,EACA;AACA,EAAA,MAAM,sBAAsB,oBAAA,GAAuB,eAAA;AAEnD,EAAA,OAAO,OAAA,CAAQ,MAAA;AAAA,IACb,eAAA;AAAA,IACA,OAAO,mBAAmB,CAAA;AAAA,IAC1B;AAAA,GACF;AACF","file":"slippage.js","sourcesContent":["import { bigMath } from \"lib/bigmath\";\nimport { BASIS_POINTS_DIVISOR, BASIS_POINTS_DIVISOR_BIGINT } from \"lib/numbers\";\n\nimport { getShouldUseMaxPrice } from \"./utils\";\n\nexport function applySlippageToPrice(\n  allowedSlippage: number,\n  price: bigint,\n  isIncrease: boolean,\n  isLong: boolean\n) {\n  const shouldIncreasePrice = getShouldUseMaxPrice(isIncrease, isLong);\n\n  const slippageBasisPoints = shouldIncreasePrice\n    ? BASIS_POINTS_DIVISOR + allowedSlippage\n    : BASIS_POINTS_DIVISOR - allowedSlippage;\n\n  return bigMath.mulDiv(\n    price,\n    BigInt(slippageBasisPoints),\n    BASIS_POINTS_DIVISOR_BIGINT\n  );\n}\n\nexport function applySlippageToMinOut(\n  allowedSlippage: number,\n  minOutputAmount: bigint\n) {\n  const slippageBasisPoints = BASIS_POINTS_DIVISOR - allowedSlippage;\n\n  return bigMath.mulDiv(\n    minOutputAmount,\n    BigInt(slippageBasisPoints),\n    BASIS_POINTS_DIVISOR_BIGINT\n  );\n}\n"]}
{"version":3,"sources":["../../../../../src/configs/twap.ts","../../../../../src/domain/orders/utils.ts","../../../../../src/domain/twap/utils.ts"],"names":[],"mappings":";;;AAAO,IAAM,4BAAA,GAA+B,CAAA;AACrC,IAAM,wBAAA,GAA2B,CAAA;AACjC,IAAM,wBAAA,GAA2B,EAAA;ACqCjC,SAAS,gBAAgB,SAAA,EAAsB;AACpD,EAAA,OAAO,CAAC,SAAA,CAAU,UAAA,EAAY,UAAU,SAAS,CAAA,CAAE,SAAS,SAAS,CAAA;AACvE;;;AChCO,SAAS,oBAAA,CACd,UACA,aAAA,EACA;AACA,EAAA,OACE,QAAA,CAAS,SAAS,CAAA,IAClB,QAAA,CAAS,WAAW,CAAA,IACpB,aAAA,IAAiB,4BACjB,aAAA,IAAiB,wBAAA;AAErB;AAEO,SAAS,yBAAyB,QAAA,EAAwB;AAC/D,EAAA,OAAO,QAAA,CAAS,KAAA,GAAQ,EAAA,GAAK,EAAA,GAAK,SAAS,OAAA,GAAU,EAAA;AACvD;AAEO,SAAS,oBAAA,CACd,QAAA,EACA,aAAA,EACA,SAAA,EACA;AACA,EAAA,MAAM,eAAA,GAAkB,QAAA,CAAS,KAAA,GAAQ,EAAA,GAAK,QAAA,CAAS,OAAA;AACvD,EAAA,MAAM,aAAa,eAAA,GAAkB,EAAA;AACrC,EAAA,MAAM,YAAY,IAAA,CAAK,IAAA,CAAK,IAAA,CAAK,GAAA,KAAQ,GAAI,CAAA;AAE7C,EAAA,OAAO,MAAA;AAAA,IACL,KAAK,KAAA,CAAM,SAAA,GAAa,UAAA,IAAc,aAAA,GAAgB,KAAM,SAAS;AAAA,GACvE;AACF;AAEO,SAAS,6BAA6B,KAAA,EAAe;AAC1D,EAAA,IAAI,QAAQ,wBAAA,EAA0B;AACpC,IAAA,OAAO,wBAAA;AAAA,EACT;AAEA,EAAA,IAAI,QAAQ,wBAAA,EAA0B;AACpC,IAAA,OAAO,wBAAA;AAAA,EACT;AAEA,EAAA,IAAI,KAAA,CAAM,KAAK,CAAA,EAAG;AAChB,IAAA,OAAO,4BAAA;AAAA,EACT;AAEA,EAAA,OAAO,KAAA;AACT;AAEO,SAAS,eAAA,CAAgB;AAAA,EAC9B,MAAA;AAAA,EACA,SAAA;AAAA,EACA,IAAA;AAAA,EACA,MAAA;AAAA,EACA,qBAAA;AAAA,EACA,QAAA;AAAA,EACA,OAAA;AAAA,EACA;AACF,CAAA,EASG;AACD,EAAA,IAAI,eAAA,CAAgB,SAAS,CAAA,EAAG;AAC9B,IAAA,OAAO,CAAA,EAAG,MAAM,CAAA,CAAA,EAAI,QAAA,CAAS,IAAA;AAAA,MAC3B;AAAA,KACD,CAAA,CAAA,EAAI,OAAO,CAAA,CAAA,EAAI,sBAAsB,CAAA,CAAA;AAAA,EACxC;AAEA,EAAA,MAAM,IAAA,GAAO,SAAS,MAAA,GAAS,OAAA;AAC/B,EAAA,OAAO,GAAG,MAAM,CAAA,CAAA,EAAI,IAAI,CAAA,CAAA,EAAI,IAAI,IAAI,qBAAqB,CAAA,CAAA;AAC3D;AAEO,SAAS,2BAAA,CACd,UACA,aAAA,EACA;AACA,EAAA,MAAM,eAAA,GAAkB,QAAA,CAAS,KAAA,GAAQ,EAAA,GAAK,QAAA,CAAS,OAAA;AACvD,EAAA,MAAM,aAAa,eAAA,GAAkB,EAAA;AACrC,EAAA,MAAM,YAAY,IAAA,CAAK,IAAA,CAAK,IAAA,CAAK,GAAA,KAAQ,GAAI,CAAA;AAE7C,EAAA,OAAO,CAAC,IAAA,KAAiB;AACvB,IAAA,OAAO,MAAA;AAAA,MACL,KAAK,KAAA,CAAM,SAAA,GAAa,UAAA,IAAc,aAAA,GAAgB,KAAM,IAAI;AAAA,KAClE;AAAA,EACF,CAAA;AACF","file":"utils.js","sourcesContent":["export const DEFAULT_TWAP_NUMBER_OF_PARTS = 5;\nexport const MIN_TWAP_NUMBER_OF_PARTS = 2;\nexport const MAX_TWAP_NUMBER_OF_PARTS = 30;\n\nexport const DEFAULT_TWAP_DURATION = {\n  minutes: 0,\n  hours: 10,\n};\n","import { OrderType } from \"./types\";\n\nexport function isMarketOrderType(orderType: OrderType) {\n  return [\n    OrderType.MarketDecrease,\n    OrderType.MarketIncrease,\n    OrderType.MarketSwap,\n  ].includes(orderType);\n}\n\nexport function isLimitOrderType(orderType: OrderType) {\n  return [\n    OrderType.LimitDecrease,\n    OrderType.LimitIncrease,\n    OrderType.LimitSwap,\n  ].includes(orderType);\n}\n\nexport function isDecreaseOrderType(orderType: OrderType) {\n  return [\n    OrderType.MarketDecrease,\n    OrderType.LimitDecrease,\n    OrderType.StopLossDecrease,\n  ].includes(orderType);\n}\n\nexport function isIncreaseOrderType(\n  orderType: OrderType\n): orderType is\n  | OrderType.MarketIncrease\n  | OrderType.LimitIncrease\n  | OrderType.StopIncrease {\n  return [\n    OrderType.MarketIncrease,\n    OrderType.LimitIncrease,\n    OrderType.StopIncrease,\n  ].includes(orderType);\n}\n\nexport function isSwapOrderType(orderType: OrderType) {\n  return [OrderType.MarketSwap, OrderType.LimitSwap].includes(orderType);\n}\n\n","import {\n  DEFAULT_TWAP_NUMBER_OF_PARTS,\n  MAX_TWAP_NUMBER_OF_PARTS,\n  MIN_TWAP_NUMBER_OF_PARTS,\n} from \"configs/twap\";\nimport { OrderType } from \"domain/orders/types\";\nimport { isSwapOrderType } from \"domain/orders/utils\";\nimport { TwapDuration } from \"domain/twap/types\";\n\nexport function getIsValidTwapParams(\n  duration: TwapDuration,\n  numberOfParts: number\n) {\n  return (\n    duration.hours >= 0 &&\n    duration.minutes >= 0 &&\n    numberOfParts >= MIN_TWAP_NUMBER_OF_PARTS &&\n    numberOfParts <= MAX_TWAP_NUMBER_OF_PARTS\n  );\n}\n\nexport function getTwapDurationInSeconds(duration: TwapDuration) {\n  return duration.hours * 60 * 60 + duration.minutes * 60;\n}\n\nexport function getTwapValidFromTime(\n  duration: TwapDuration,\n  numberOfParts: number,\n  partIndex: number\n) {\n  const durationMinutes = duration.hours * 60 + duration.minutes;\n  const durationMs = durationMinutes * 60;\n  const startTime = Math.ceil(Date.now() / 1000);\n\n  return BigInt(\n    Math.floor(startTime + (durationMs / (numberOfParts - 1)) * partIndex)\n  );\n}\n\nexport function changeTwapNumberOfPartsValue(value: number) {\n  if (value < MIN_TWAP_NUMBER_OF_PARTS) {\n    return MIN_TWAP_NUMBER_OF_PARTS;\n  }\n\n  if (value > MAX_TWAP_NUMBER_OF_PARTS) {\n    return MAX_TWAP_NUMBER_OF_PARTS;\n  }\n\n  if (isNaN(value)) {\n    return DEFAULT_TWAP_NUMBER_OF_PARTS;\n  }\n\n  return value;\n}\n\nexport function getTwapOrderKey({\n  twapId,\n  orderType,\n  pool,\n  isLong,\n  collateralTokenSymbol,\n  swapPath,\n  account,\n  initialCollateralToken,\n}: {\n  twapId: string;\n  orderType: OrderType;\n  pool: string;\n  collateralTokenSymbol: string;\n  initialCollateralToken: string;\n  isLong: boolean;\n  swapPath: string[];\n  account: string;\n}) {\n  if (isSwapOrderType(orderType)) {\n    return `${twapId}-${swapPath.join(\n      \"-\"\n    )}-${account}-${initialCollateralToken}`;\n  }\n\n  const type = isLong ? \"long\" : \"short\";\n  return `${twapId}-${type}-${pool}-${collateralTokenSymbol}`;\n}\n\nexport function makeTwapValidFromTimeGetter(\n  duration: TwapDuration,\n  numberOfParts: number\n) {\n  const durationMinutes = duration.hours * 60 + duration.minutes;\n  const durationMs = durationMinutes * 60;\n  const startTime = Math.ceil(Date.now() / 1000);\n\n  return (part: number) => {\n    return BigInt(\n      Math.floor(startTime + (durationMs / (numberOfParts - 1)) * part)\n    );\n  };\n}\n"]}
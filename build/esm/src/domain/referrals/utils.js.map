{"version":3,"sources":["../../../../../src/domain/referrals/utils.ts"],"names":[],"mappings":";;AAIO,SAAS,oBAAoB,CAAA,EAWH;AAC/B,EAAA,MAAM;AAAA,IACJ,gBAAA;AAAA,IACA,sBAAA;AAAA,IACA,kBAAA;AAAA,IACA,eAAA;AAAA,IACA,SAAA;AAAA,IACA,MAAA;AAAA,IACA,WAAA;AAAA,IACA,aAAA;AAAA,IACA,mBAAA;AAAA,IACA;AAAA,GACF,GAAI,CAAA;AAEJ,EAAA,IACE,CAAC,gBAAA,IACD,CAAC,sBAAA,IACD,CAAC,SAAA,IACD,MAAA,KAAW,MAAA,IACX,WAAA,KAAgB,MAAA,IAChB,aAAA,KAAkB,MAAA,IAClB,CAAC,kBAAA,EACD;AACA,IAAA,OAAO,MAAA;AAAA,EACT;AAEA,EAAA,MAAM,kBAAA,GAAA,CAAsB,mBAAA,IAAuB,EAAA,IAAM,EAAA,GAAK,mBAAA,GAAuB,aAAA;AAErF,EAAA,OAAO;AAAA,IACL,gBAAA;AAAA,IACA,sBAAA;AAAA,IACA,kBAAA;AAAA,IACA,eAAA;AAAA,IACA,SAAA,EAAW,SAAA;AAAA,IACX,MAAA;AAAA,IACA,WAAA;AAAA,IACA,iBAAA,EAAmB,mBAAmB,WAAW,CAAA;AAAA,IACjD,aAAA,EAAe,kBAAA;AAAA,IACf,cAAA,EAAgB,mBAAmB,kBAAkB,CAAA;AAAA,IACrD;AAAA,GACF;AACF","file":"utils.js","sourcesContent":["import { basisPointsToFloat } from \"lib/numbers\";\n\nimport type { UserReferralInfo } from \"./types\";\n\nexport function getUserReferralInfo(p: {\n  userReferralCode: string | undefined;\n  userReferralCodeString: string | undefined;\n  referralCodeForTxn: string | undefined;\n  attachedOnChain: boolean;\n  codeOwner: string | undefined;\n  tierId: number | undefined;\n  totalRebate: bigint | undefined;\n  discountShare: bigint | undefined;\n  customDiscountShare?: bigint | undefined;\n  error?: Error;\n}): UserReferralInfo | undefined {\n  const {\n    userReferralCode,\n    userReferralCodeString,\n    referralCodeForTxn,\n    attachedOnChain,\n    codeOwner,\n    tierId,\n    totalRebate,\n    discountShare,\n    customDiscountShare,\n    error,\n  } = p;\n\n  if (\n    !userReferralCode ||\n    !userReferralCodeString ||\n    !codeOwner ||\n    tierId === undefined ||\n    totalRebate === undefined ||\n    discountShare === undefined ||\n    !referralCodeForTxn\n  ) {\n    return undefined;\n  }\n\n  const finalDiscountShare = (customDiscountShare ?? 0n) > 0n ? customDiscountShare! : discountShare;\n\n  return {\n    userReferralCode,\n    userReferralCodeString,\n    referralCodeForTxn,\n    attachedOnChain,\n    affiliate: codeOwner,\n    tierId,\n    totalRebate,\n    totalRebateFactor: basisPointsToFloat(totalRebate),\n    discountShare: finalDiscountShare,\n    discountFactor: basisPointsToFloat(finalDiscountShare),\n    error,\n  };\n}\n\n\n\n\n\n\n\n\n\n\n\n\n"]}
{"version":3,"sources":["../../../../../src/lib/errors/transactionsErrors.ts"],"names":["TxErrorType","CustomErrorName"],"mappings":"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","file":"transactionsErrors.js","sourcesContent":["export enum TxErrorType {\n  NotEnoughFunds = \"NOT_ENOUGH_FUNDS\",\n  UserDenied = \"USER_DENIED\",\n  Slippage = \"SLIPPAGE\",\n  RpcError = \"RPC_ERROR\",\n  NetworkChanged = \"NETWORK_CHANGED\",\n  Expired = \"EXPIRED\",\n}\n\nexport type ErrorPattern = { msg?: string; code?: number };\n\nconst TX_ERROR_PATTERNS: { [key in TxErrorType]: ErrorPattern[] } = {\n  [TxErrorType.NotEnoughFunds]: [\n    { msg: \"insufficient funds for gas\" },\n    { msg: \"not enough funds for gas\" },\n    { msg: \"failed to execute call with revert code InsufficientGasFunds\" },\n    { msg: \"insufficient funds for transfer\" },\n  ],\n  [TxErrorType.UserDenied]: [\n    { msg: \"User denied transaction signature\" },\n    { msg: \"User rejected\" },\n    { msg: \"User cancelled\" },\n    { msg: \"Cancelled\" },\n    { msg: \"Cancelled by user\" },\n    { msg: \"user rejected action\" },\n    { msg: \"ethers-user-denied\" },\n    { msg: \"Action cancelled by user\" },\n    { msg: \"Signing aborted by user\" },\n  ],\n  [TxErrorType.Slippage]: [\n    { msg: \"Router: mark price lower than limit\" },\n    { msg: \"Router: mark price higher than limit\" },\n  ],\n  [TxErrorType.NetworkChanged]: [\n    { msg: \"network changed\" },\n    { msg: \"Invalid network\" },\n    { msg: \"chainId should be same\" },\n  ],\n  [TxErrorType.Expired]: [{ msg: \"Request expired\" }],\n  [TxErrorType.RpcError]: [\n    // @see https://eips.ethereum.org/EIPS/eip-1474#error-codes\n    { code: -32700 }, // Parse error: Invalid JSON\n    { code: -32600 }, // Invalid request: JSON is not a valid request object\n    { code: -32601 }, // Method not found: Method does not exist\n    { code: -32602 }, // Invalid params: Invalid method parameters\n    { code: -32603 }, // Internal error: Internal JSON-RPC error\n    { code: -32000 }, // Invalid input: Missing or invalid parameters\tnon-standard\n    { code: -32001 }, // Resource not found: Requested resource not found\n    { code: -32002 }, // Resource unavailable: Requested resource not available\n    { code: -32003 }, // Transaction rejected: Transaction creation failed\n    { code: -32004 }, // Method not supported: Method is not implemented\n    { code: -32005 }, // Limit exceeded: Request exceeds defined limit\n    { code: -32006 }, // JSON-RPC version not supported: Version of JSON-RPC protocol is not supported\n    { msg: \"Non-200 status code\" },\n    { msg: \"Request limit exceeded\" },\n    { msg: \"Internal JSON-RPC error\" },\n    { msg: \"Response has no error or result\" },\n    { msg: \"we can't execute this request\" },\n    { msg: \"couldn't connect to the network\" },\n  ],\n};\n\nexport enum CustomErrorName {\n  EndOfOracleSimulation = \"EndOfOracleSimulation\",\n  InsufficientExecutionFee = \"InsufficientExecutionFee\",\n  OrderNotFulfillableAtAcceptablePrice = \"OrderNotFulfillableAtAcceptablePrice\",\n  InsufficientSwapOutputAmount = \"InsufficientSwapOutputAmount\",\n}\n\nexport function getIsUserRejectedError(errorType: TxErrorType) {\n  return errorType === TxErrorType.UserDenied;\n}\n\nexport function getIsUserError(errorType: TxErrorType) {\n  return [TxErrorType.UserDenied, TxErrorType.NetworkChanged, TxErrorType.Expired, TxErrorType.NotEnoughFunds].includes(\n    errorType\n  );\n}\n\nexport type TxError = {\n  message?: string;\n  code?: number | string;\n  data?: any;\n  error?: any;\n};\n\n/**\n * @deprecated Use `parseError` instead.\n */\nexport function extractTxnError(ex: TxError): [string, TxErrorType | null, any] | [] {\n  if (!ex) {\n    return [];\n  }\n\n  // ethers v6 moved error to `.info` field ü§∑‚Äç‚ôÇÔ∏è,\n  // we also fallback to `ex` cos we might catch errors from ethers v5\n  // from some outdated dependency like @davatar/react\n  ex = (ex as any)?.info ?? ex;\n  let message = ex.error?.message || ex.data?.message || ex.message;\n  let code = ex.error?.code || ex.code;\n\n  if (ex.error?.body) {\n    try {\n      const parsed = JSON.parse(ex.error?.body);\n      if (parsed?.error?.message) {\n        message = parsed.error.message;\n      }\n      if (parsed?.error?.code) {\n        code = parsed.error.code;\n      }\n    } catch (e) {\n      // do nothing\n    }\n  }\n\n  if (!message && !code) {\n    return [];\n  }\n\n  for (const [type, patterns] of Object.entries(TX_ERROR_PATTERNS)) {\n    for (const pattern of patterns) {\n      const matchCode = pattern.code && code === pattern.code;\n      const matchMessage = pattern.msg && message && message.includes(pattern.msg);\n\n      if (matchCode || matchMessage) {\n        return [message, type as TxErrorType, ex.data];\n      }\n    }\n  }\n\n  return [message, null, ex.data];\n}\n\n/**\n * @deprecated Use `parseError` instead.\n */\nexport function extractDataFromError(errorMessage: unknown) {\n  if (typeof errorMessage !== \"string\") return null;\n\n  const pattern = /data=\"([^\"]+)\"/;\n  const match = errorMessage.match(pattern);\n\n  if (match && match[1]) {\n    return match[1];\n  }\n  return null;\n}\n"]}